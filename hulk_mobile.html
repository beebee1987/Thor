<!DOCTYPE html>
<!-- README
a) URL Inputs - pId & profileId
b) Change the var socket constant value, i.e. IP of the Web-Socket Host Running in SHIELD
c) 
-->
<html lang="en" class="no-js">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Hulk Mobile</title>
        <meta name="description" content="Combine isometric &amp; 3D grids, 360 degree image, interactive popup" />
        <meta name="keywords" content="isometric, grid, images, masonry, perspective" />
        <meta name="author" content="KC" />
        <link rel="shortcut icon" href="favicon.ico">
        <link rel="stylesheet" type="text/css" media="screen" href="https://cdn.rawgit.com/resir014/Clear-Sans-Webfont/v1.1.1/css/clear-sans.css">
        <link rel="stylesheet" type="text/css" href="css/normalize.css" />
        <link rel="stylesheet" type="text/css" href="css/demo.css" />
        <link rel="stylesheet" type="text/css" href="css/component.css" />
        <link rel="stylesheet" type="text/css" href="css/weatherslider.css" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <link rel="stylesheet" media="screen and (max-width:1024px)" type="text/css" href="css/mobile.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> 
        <script src="js/modernizr.custom.js"></script>
        <!--                <style>
                            @media only screen and (max-width:500px) {
                                /* For mobile phones: */
                                [class*="col-"] {
                                    width: 100%;
                                    height: 500%;
                                }
                            }
                        </style>-->
    </head>
    <body class="demo-1">
        <main id="main">
            <header class="codrops-header">
                <h1 id="divToShowHide" class="BeforeScroll">Just for You!</h1>
                <span class="spanWelcome"></span>



            </header>


            <div id="modal-container">
                <div class="modal-background">
                    <div class="modal">


                        <div class="flex-grid">
                            <div class="col">
                                <div class="threesixty-wrapper">
                                    <div class="threesixty" data-path="img/360/p11/p11{index}.jpg" data-count="15">
                                        put your preloader here 
                                        <div class="ui-spinner">
                                            <span class="side side-left">
                                                <span class="fill"></span>
                                            </span>
                                            <span class="side side-right">
                                                <span class="fill"></span>
                                            </span>
                                        </div>
                                        end preloader 
                                    </div>
                                </div>

                            </div>

                            <div class="col" id="item-details">

                                <div id="closeModal" class="button">OK</div>                      
                            </div>


                        </div>




                    </div>
                </div>
            </div>

            <div id="modal">
                <!--                            <div class="modalconent">-->
                <!--                                <span class="close">&times;</span>-->
                <h1></h1>

                <!--                               <video id="videoContainer" width="980" height="388" controls loop autoplay>
                                                    <source src="https://dl.dropboxusercontent.com/s/i5mw047oi9npnex/Umbrella%20Commercial.mp4?dl=0" id="myvideo" type="video/mp4">
                                                    <source src="https://dl.dropboxusercontent.com/s/2yewgre17voaqb4/Hot%20coffee.mp4?dl=0" type="video/mp4">
                                                    <source src="https://dl.dropboxusercontent.com/s/ogxklvyr0uizxa2/Ice-Cream%20-%20Magnum.mp4?dl=0" type="video/mp4">
                                              </video> -->
                <!--src="https://dl.dropboxusercontent.com/s/i5mw047oi9npnex/Umbrella%20Commercial.mp4?dl=0"-->                                   
                <video id="myvideo"  controls autoplay style="background: transparent;">
                </video>                                    
                <!--                            </div>-->
            </div>
            <!--
                https://dl.dropboxusercontent.com/content_link/hk9pn3yMcq370W5OxHxeTsP1D2lH6nc68GqXYMxrjNulUGdaHCQ6SYolTJQgXlDq/file.mov?dl=1
                https://dl.dropboxusercontent.com/s/ypyngl68eweyvfx/Umbrella%20TVC.mov?dl=0
                https://dl.dropboxusercontent.com/content_link/8LRo7hnDiNZtgJmn6AwWGDK5ATmczXuccxAo8q71GxNJBpYAFtgzEpxyr6pD9L8U/file?dl=1
                https://dl.dropboxusercontent.com/s/ypyngl68eweyvfx/Umbrella%20TVC.mov?dl=0
                https://dl.dropboxusercontent.com/s/i5mw047oi9npnex/Umbrella%20Commercial.mp4?dl=0
            -->

            <!-- <div class="content">
              <h1>Modal Animations</h1>
              <div class="buttons">
                <div id="one" class="button">Unfolding</div>
                <div id="two" class="button">Revealing</div>
                <div id="three" class="button">Uncovering</div>
                <div id="four" class="button">Blow Up</div><br>
                <div id="five" class="button">Meep Meep</div>
                <div id="six" class="button">Sketch</div>
                <div id="seven" class="button">Bond</div>
              </div>
            </div> -->

            <!--weather--> 
            <div class="weather" id="dim">

                <div id="ws">
                    <div id="wslogo"></div>
                    <div class="clear"></div>
                </div>

                <div id="ws-examples">
                    <div class="inner">

                        <div class="ws-example">
                            <div class="ws-ex-inner ws-ex-inner-responsive">

                                <div id="weatherslider">								
                                    <!--<span class="ws-location"></span>-->
                                    <span class="ws-location">Kuala Lumpur, Malaysia</span>
                                    <!--<span class="ws-location">KUALA LUMPUR, MALAYSIA</span>-->
                                    <!--                                                                        <span class="ws-location">GEOLOCATION</span>	                                                                        -->
                                </div>

                                <!-- <p class="desc">
                                        WeatherSlider with various locations (mouse your mouse over the weather information box to show 3 days forecast).<br>
                                        Move your mouse over the top half of the slider to show the Custom Location Search Bar to enter your location.
                                </p> -->
                            </div>
                        </div>
                    </div>
                </div>

                <div id="side" class="sidebar">					  
                </div>



            </div>


            <!--isometric view-->
            <!--                        <div class="test2">-->
            <div id = "isometric" style="display: block;" class="isolayer isolayer--scroll1 isolayer--shadow">
                <ul class="grid grid--effect-flip">					
                </ul>
            </div>
            <!--                        </div>-->


        </main>
        <!-- <a class="pater" href="https://goo.gl/k3vxNx">
                <h2 class="pater__title" aria-label="PageCloud"><img src="img/PageCloud_logo.svg" alt="PageCloud Logo"/></h2>
                <p class="pater__desc">Take control of your website with features you won't find anywhere else. Find out why PageCloud is the world's most advanced website creator today!</p>
        </a> -->
        <script src="js/imagesloaded.pkgd.min.js"></script>
        <script src="js/masonry.pkgd.min.js"></script>
        <script src="js/dynamics.min.js"></script>
        <script src="js/classie.js"></script>
        <script src="js/animOnScroll.js"></script>
        <script src="js/main.js"></script>

        <script src="js/jquery.js" type="text/javascript"></script>
        <script src="js/jquery-easing.js" type="text/javascript"></script>
        <script src="js/jquery-animate-background-position.js" type="text/javascript"></script>
        <script src="https://maps.googleapis.com/maps/api/js?sensor=false&language=en" type="text/javascript"></script>
        <script src="js/weatherslider.kreaturamedia.jquery.js" type="text/javascript"></script>
        <script src="js/jquery.threesixty.js" type="text/javascript"></script>		
        <script src="https://www.promisejs.org/polyfills/promise-7.0.4.min.js"></script>
        <script>
            (function () {

                //playMovie(101);
                $('#isometric').show();
                //$('#isometric').hide();
                $('#modal').hide();
                //$('#modal').show();
                //stopMovie();

                var width = screen.width;
                var sidebar = $('.sidebar');
                var spanWelcome = $('.spanWelcome');
                var greetingWord = '';
                var $threeSixty = $('.threesixty');

                var json;

                var socket = new WebSocket('ws://192.168.1.117:2000');

//                        window.onload = function () {
//                            document.getElementById('button').onclick = function () {
//                                document.getElementById('modal').style.display = "none"
//                            };
//                        };

//                        var span = document.getElementsByClassName("close")[0];
//                        span.onclick = function() {
////                            modal.style.display = "none";
////                            $("#myvideo")[0].pause();
//                              stopMovie();
//                        }

                socket.onopen = function (event) {
//                          socketStatus.innerHTML = 'Connected to: ' + event.currentTarget.URL;
//                          socketStatus.className = 'open';
//                            console.log(event);
//                            
//                            console.log('Connected to: ' + event.currentTarget.url);
//                            console.log('open');

                    var message = 'Hulk2';

                    // Send the message through the WebSocket.
                    socket.send(message);
                };




                // Handle messages sent by the server.
                socket.onmessage = function (event) {
                    var data = event.data;
//                      pid=100&profileid=100 // 101 101 //video                      
                    var dataSplited = data.split("="); //pid=1&profileid=1&pname=KC
                    if(dataSplited.length < 2){
                        return;
                    }
                    
                    var dataSplited2 = dataSplited[1].split("&"); //pid
                    var dataSplited3 = dataSplited[2].split("&"); //customer name
                    var dataSplited4 = dataSplited[3].split("&"); //customer age
                    //pid=100&pname=123&page=12&pgender=M
                    
                    var pId = dataSplited2[0]; // pId
                    var pName = dataSplited3[0]; //customer name
                    var pAge = dataSplited4[0]; //customer age
                    var pGender = dataSplited[4]; //customer gender
                    var proceedAgeCondition = false;

                    if (pId != 100) {
                        // here is the logic for age and gender, and return pId 
                        proceedAgeCondition = true;
                    }

                    if (proceedAgeCondition) {
                        console.log(pAge, pGender);
                        var steps = new Promise(
                                function (resolve, reject) {
                                    $.ajax({
                                        url: "http://knexfmw1.knextech.net:8081/ords/harith/restservice/v1.1/promotion_products?age=" + pAge + "&gender=" + pGender,
                                        type: "GET",
                                        processData: false,
                                        contentType: "application/json",
                                        success: function (result) {
                                            resolve(result);
                                        },
                                        error: function (jqXHR, textStatus, errorThrown) {
                                            console.log(jqXHR, textStatus, errorThrown);
                                        }
                                    });
                                });
                        steps.then(function (message) {
                            json = message;
                            scrollerReset();
                            launchIsometric(json, 2); //2 is mean second time load isometric
                        });
                    }

                    greetingMessage(pName);

                    if (pId == 100) { //sunny day                                                      
                        playMovie(pId);
                        $('#isometric').hide();
                        $('#modal').show();
                        //playMovie();
                    } else if (pId == 101) { //rainy day                              
                        playMovie(pId);
                        $('#isometric').hide();
                        $('#modal').show();
                        //playMovie();
                    } else {
                        stopMovie();
                        $('#isometric').show();
                        $('#modal').hide();
                    }
                    // if mesage is personalID
                    // if message is 


                };

                function scrollerReset() {
                    var scroller = $('.pseudo-scroller');//make page longer                                                                                          
                    scroller.hide('slow', function () {
                        scroller.remove();
                    });
                }

                function launchIsometric(json, version) {
                   
                    var ul = $('.grid--effect-flip');

                    //stop it dont make it longer
                    ul.children().remove();

                    var liCollection = '';

//                    var d1 = dateFrom.split("/");
//                    var d2 = dateTo.split("/");
//                    var c = dateCheck.split("/");
//
//                    var from = new Date(d1[2], parseInt(d1[1])-1, d1[0]);  // -1 because months are from 0 to 11
//                    var to   = new Date(d2[2], parseInt(d2[1])-1, d2[0]);
//                    var check = new Date(c[2], parseInt(c[1])-1, c[0]);
//
//                    console.log(check > from && check < to)


                    $.each(json.items, function (i, item) {

                        var dateFrom = Date.parse(item.effective_date);
                        var dateTo = Date.parse(item.expire_date);
                        var today = new Date(); //today
                        var isValidDate = "false";

                        if (today.getTime() >= dateFrom && today.getTime() <= dateTo) {
                            isValidDate = "true";
                        }

                        liCollection += '<li class="grid__item">';
                        liCollection += '<a class="grid__link"' + ' id="' + item.id + '">';
                        liCollection += '<img class="grid__img layer" src="' + item.side_image2 + '" />';
                        liCollection += '<img class="grid__img layer" src="' + item.side_image1 + '" />';
                        liCollection += '<img class="grid__img layer" id="main" src="' + item.main_image + '" />';
                        liCollection += '<span class="grid__title">' + item.name + '</span>';
                        liCollection += '<p class="grid__itemname" style="display: none;">' + item.description + '</p>';//4
                        liCollection += '<p class="grid__oriprice" style="display: none;">RM ' + item.selling_price + '</p>';//5
                        liCollection += '<p class="grid__promoprice" style="display: none;">RM ' + item.promotion_price + '</p>';//6
                        liCollection += '<p class="grid__location" style="display: none;">' + item.location + '</p>';//7
                        liCollection += '<p class="grid__product_code" style="display: none;">' + item.product_code + '</p>';//8
                        liCollection += '<p class="grid__sku" style="display: none;">' + item.sku + '</p>';//9
                        liCollection += '<p class="grid__promotion_flag" style="display: none;">' + isValidDate + '</p>';//10
                        // liCollection += '<p class="grid__colour" style="display: none;">'+ item.colour +'</p></li>';      
                    });

                    if (version == 2) {
                        ul.append(liCollection).hide().show('slow');
                    } else {
                        ul.append(liCollection);
                    }







                    [].slice.call(document.querySelectorAll('.isolayer')).forEach(function (el) {
                        new IsoGrid(el, {
                            type: 'scrollable',
                            transform: 'translateX(-15vw) translateY(275px) rotateX(45deg) rotateZ(45deg)',
                            stackItemsAnimation: {
                                properties: function (pos) {
                                    return {
                                        translateZ: (pos + 1) * 50,
                                        rotateZ: getRandomInt(-3, 3)
                                    };
                                },
                                options: function (pos, itemstotal) {
                                    return {
                                        type: dynamics.bezier,
                                        duration: 500,
                                        points: [{"x": 0, "y": 0, "cp": [{"x": 0.2, "y": 1}]}, {"x": 1, "y": 1, "cp": [{"x": 0.3, "y": 1}]}],
                                        //delay: (itemstotal-pos-1)*40
                                    };
                                }
                            },
                            onGridLoaded: function () {
                                classie.add(document.body, 'grid-loaded');
                            }
                        });
                    });



                    $(".grid__link").click(function (data) {
                        //get ID

                        var filePath = $(this).context.childNodes[2].src; //eg: file:///Users/user/MyWork/iSolutionProjects/IsometricGrids/img/p2/p21.jpg
                        var n = filePath.lastIndexOf('/'); // get last slash number                                
                        var fileName = filePath.substring(n + 1); //get the last slash file name                                
                        var dotIndex = fileName.lastIndexOf('.'); //get fileName without extension number
                        var frontFileName = fileName.slice(0, dotIndex); //get fileName without extension                                                                 

                        //Get From JSON harcode                                
                        var description = data.currentTarget.childNodes[4].innerHTML; //description 
                        var promotion_price = data.currentTarget.childNodes[6].innerHTML;
                        var selling_price = data.currentTarget.childNodes[5].innerHTML;
                        var location = data.currentTarget.childNodes[7].innerHTML;
                        var product_code = data.currentTarget.childNodes[8].innerHTML;
                        var sku = data.currentTarget.childNodes[9].innerHTML;
                        var validDate = data.currentTarget.childNodes[10].innerHTML;

                        var path;
                        var count;
                        // get ID for read the series ID and image for 3D

                        path = 'img/360/' + frontFileName + '/' + frontFileName + '{index}.jpg';
                        count = 15; //limit set of transition images per subject

                        // refresh 360 degree image

                        var q = $threeSixty.reload(path, count);


                        var itemWord = '';
                        var itemDetails = $('#item-details');
                        //itemDetails.html('');

                        itemWord += '<h1>' + description + '</h1>';
                        itemWord += '<h2>Code: ' + product_code + '</h2>';
                        itemWord += '<h2>Sku: ' + sku + '</h2>';
                        if (validDate == "true") {
                            itemWord += '<h2>Promotion Price: ' + promotion_price + '</h2>';
                        }
                        itemWord += '<h2>Original Price: ' + selling_price + '</h2>';
                        itemWord += '<h2>Location: ' + location + '</h2>';
                        // itemWord += '<h2>Colour: '+ colour +'</h2>';
                        itemWord += '<div id="closeModal" class="button">OK</div>';

                        itemDetails.empty().prepend(itemWord);


                        //apend button will no function, so need define again .click for it
                        $('#closeModal').click(function () {
                            $('#modal-container').addClass('out');
                            $('body').removeClass('modal-active');
                        })


                        $('#modal-container').removeAttr('class').addClass('one');
                        $('body').addClass('modal-active');

                        //ajax call here
                    });
                }

                function greetingMessage(pName) {
                    spanWelcome.html('');
                    sidebar.html('');


                    greetingWord = '';
                    greetingWord += '<h3>';
                    // depend what condition
                    if (pName) {
                        greetingWord += 'Welcome, ' + pName + '!';
                    } else {
                        greetingWord += 'Welcome!';
                    }
                    // depend what condition

                    greetingWord += '</h3>';

                    if (width < 1366) {
                        spanWelcome.append(greetingWord);
                        $('.spanWelcome').show();
                        $('.sidebar').hide();
                    } else {
                        sidebar.append(greetingWord);
                        $('.sidebar').show();
                        $('.spanWelcome').hide();
                    }
                }


                var options = {
                    enableHighAccuracy: true,
                    timeout: 5000,
                    maximumAge: 0
                };

                function success(pos) {

                    console.log("pos");
                    console.log(pos);

                    var crd = pos.coords;

                    console.log("crd");
                    console.log(crd);

                    var googleapi = 'https://maps.googleapis.com/maps/api/geocode/json?latlng=' + crd.latitude + ',' + crd.longitude;
                    $.ajax({
                        url: googleapi,
                        success: function (data) {
                            $(".ws-location").html(data.results[2].address_components[0].long_name);//  too slow                                 

                            $('#weatherslider').weatherSlider({
                                WWOAPIKey: '8e485b7ac807474fb7160805172707',
                                premiumAPIKey: true,
                                imgPath: 'img/weatherslider/'

                                        // To get your own API key, please sign up on World Weather Online: http://developer.worldweatheronline.com/signup.aspx
                                        // With a valid WWO account you can use the Premium API for free for two months.

                                        // If you got you own API key from World Weather Online, please replace the 'your_api_key' string above with your API key and the example will work.

                                        // You can find a working example of WeatherSlider on the public demo site of the plugin: https://kreaturamedia.com/weatherslider-premium-jquery-weather-widget/
                            });
                        }
                    });

//                            console.log('Your current position is:');
//                            console.log('Latitude :' + crd.latitude);
//                            console.log('Longitude:' + crd.longitude);
//                            console.log('More or less' + crd.accuracy);
                }
                ;

                function error(err) {
                    console.log(err);
                    console.warn('ERROR' + err.code + ':' + err.message);

                    $(".ws-location").html('Kuala Lumpur');

                    $('#weatherslider').weatherSlider({
                        WWOAPIKey: '8e485b7ac807474fb7160805172707',
                        premiumAPIKey: true,
                        imgPath: 'img/weatherslider/'

                                // To get your own API key, please sign up on World Weather Online: http://developer.worldweatheronline.com/signup.aspx
                                // With a valid WWO account you can use the Premium API for free for two months.

                                // If you got you own API key from World Weather Online, please replace the 'your_api_key' string above with your API key and the example will work.

                                // You can find a working example of WeatherSlider on the public demo site of the plugin: https://kreaturamedia.com/weatherslider-premium-jquery-weather-widget/
                    });

                }
                ;


                navigator.geolocation.getCurrentPosition(success, error, options);


                function playMovie(pId) {

                    modal.style.display = "block";

                    var myvid = document.getElementById('myvideo');
                    var myvids;

                    if (pId == 100) {
                        myvids = [
                            "https://dl.dropboxusercontent.com/s/0y7es9t2yvv9vqm/Ice-Cream%20-%20Magnum.mp4?dl=0",
                            "https://dl.dropboxusercontent.com/s/6v7bkvfyg7ea9gs/Coke.mp4?dl=0"
                        ];
                        myvid.src = "https://dl.dropboxusercontent.com/s/0y7es9t2yvv9vqm/Ice-Cream%20-%20Magnum.mp4?dl=0";
                    } else if (pId == 101) {
                        myvids = [
                            "https://dl.dropboxusercontent.com/s/73uwwb37l8a4wfj/Umbrella%20TVC.mp4?dl=0",
                            "https://dl.dropboxusercontent.com/s/gz0jzi3q3rws1zb/Hot%20coffee.mp4?dl=0"
                        ];
                        myvid.src = "https://dl.dropboxusercontent.com/s/73uwwb37l8a4wfj/Umbrella%20TVC.mp4?dl=0";
                    }

                    myvid.play();
                    var activeVideo = 0;

                    myvid.addEventListener('ended', function (e) {
                        // update the new active video index
                        activeVideo = (++activeVideo) % myvids.length;

                        // update the video source and play
                        myvid.src = myvids[activeVideo];
                        myvid.play();
                    });

                    //set video timeout in 5 sec for testing
//                            videoPlay(true);
//                            
//                            setTimeout(function(){
//                                videoPlay(false);
//                            },5000);


                    //$("#videoContainer")[0].play();                                                         
                }

                //set video playing hide and show isometric in 5 seconds
//                        function videoPlay(s){
//                            console.log(s);
//                            if(s){

//                            }else{
//                                $('#isometric').show();
//                                $('#modal').hide();
//                                stopMovie();
//                                isobind(); //reset the isometric design when modal hide and isometric is show
//                            }
//                        }

                function stopMovie() {
                    modal.style.display = "none";
                    var myvid = document.getElementById('myvideo');
                    myvid.pause();
                    //$("#myvideo")[0].pause();
                    //$("#videoContainer")[0].pause();
                }

                function getRandomInt(min, max) {
                    return Math.floor(Math.random() * (max - min + 1)) + min;
                }

                function getCount(foldername)
                {
                    $.ajax({
                        url: foldername,
                        success: function (data) {
//                                    var parser = new DOMParser(),
//                                        doc = parser.parseFromString(data, 'text/html');
//
//                                    //output the file table
//                                    $("#files").append(doc.querySelector('table').outerHTML);
//
//                                    //or return the number of files
//                                    //tr = icon, filename, date, size, desc
//                                    //consider all rows with a size value holding a number as a vlid file
//                                    var fileCount = 0,
//                                        rows = doc.querySelector('table').querySelectorAll('tr');
//
//                                    for (var i=0;i<rows.length;i++) {
//                                        if (rows[i].children[3]) {
//                                            if (parseInt(rows[i].children[3].innerText)>0) fileCount++;         
//                                        }
//                                    }
//                                    $("#fileCount").text(fileCount+' files');
                        }
                    });
                }

                function getParameterByName(name, url) {
                    if (!url)
                        url = window.location.href;
                    name = name.replace(/[\[\]]/g, "\\$&");
                    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                            results = regex.exec(url);
                    if (!results)
                        return null;
                    if (!results[2])
                        return '';
                    return decodeURIComponent(results[2].replace(/\+/g, " "));
                }

                //Load all data into iSometric image first

                //Get Json must have a server
//                        $.getJSON("data/men.json", function(result){
//                            console.log(result);
//                        }).done(function() {
//                            //load slice call
//                            console.log( "second success" );
//                        }).fail(function(error) {
//                            console.log('Error in getting item data: ' + error.message);
//                        }).always(function() {
//                            console.log( "complete" );
//                        });;

                //get Parameter from URL
                var pId = getParameterByName('pId');
                var profileId = getParameterByName('profileId');
                //var profileId = 2;                                  


                spanWelcome.html('');
                sidebar.html('');
                //localStorage.removeItem("ISO_INFO");
                var infoObj = JSON.parse(localStorage.getItem("ISO_INFO"));
                var customerName;
                var customerAge;
                var customerGender;
                var url;

                if (infoObj) {
                    var customerName = infoObj.name;
                    var customerAge = infoObj.age;
                    var customerGender = infoObj.gender;
                    url = "http://knexfmw1.knextech.net:8081/ords/harith/restservice/v1.1/promotion_products?age=" + customerAge + "&gender=" + customerGender;
                }else{
                    url = "http://knexfmw1.knextech.net:8081/ords/harith/restservice/v1.1/promotion_products?pid=6";
                }

                console.log("url");
                console.log(url);
                
                $(window).bind('orientationchange', function (event) {
                    width = screen.width;
                });


                greetingMessage(customerName);

                //check what is the data get from Shield

                var steps = new Promise(
                        function (resolve, reject) {
                            $.ajax({
                                url: url,
                                type: "GET",
                                processData: false,
                                contentType: "application/json",
                                success: function (result) {
                                    resolve(result);
                                },
                                error: function (jqXHR, textStatus, errorThrown) {
                                    console.log(jqXHR, textStatus, errorThrown);
                                }
                            });
                        });
                steps.then(function (message) {
                    json = message;
                    launchIsometric(json, 1); //1 is mean second time load isometric
                });






//			$('#weatherslider').weatherSlider({
//
//					WWOAPIKey: '01103d6f32544fedab550933170106',
//                                        premiumAPIKey: true,
//                                        imgPath: 'img/weatherslider/'
//
//					// To get your own API key, please sign up on World Weather Online: http://developer.worldweatheronline.com/signup.aspx
//					// With a valid WWO account you can use the Premium API for free for two months.
//
//					// If you got you own API key from World Weather Online, please replace the 'your_api_key' string above with your API key and the example will work.
//
//					// You can find a working example of WeatherSlider on the public demo site of the plugin: https://kreaturamedia.com/weatherslider-premium-jquery-weather-widget/
//
//			});



                //Take your div into one js variable
                var div = $("#divToShowHide");
                //Take the current position (vertical position from top) of your div in the variable
                var pos = div.position();
                //Now when scroll event trigger do following
                $(window).scroll(function () {

                    var windowpos = $(window).scrollTop();

                    //Now if you scroll more than 100 pixels vertically change the class to AfterScroll
                    // I am taking 100px scroll, you can take whatever you need

                    if (windowpos >= (pos.top + 400)) {
                        //div.addClass("AfterScroll");
                    }
                    //If scroll is less than 100px, remove the class AfterScroll so that your content will be hidden again 
                    else {
                        //div.removeClass("AfterScroll");
                    }
                    //Note: If you want the content should be shown always once you scroll and do not want to hide it again when go to top agian, no need to write the else part
                });

                $('.button').click(function () {
                    var buttonId = $(this).attr('id');


                    $('#modal-container').removeAttr('class').addClass(buttonId);
                    $('body').addClass('modal-active');
                });



                $('#closeModal').on('click', function () {
                    $('#modal-container').addClass('out');
                    $('body').removeClass('modal-active');
                });


                $threeSixty.threeSixty({
                    dragDirection: 'horizontal',
                    useKeys: true,
                    draggable: true
                });

                $('.next').click(function () {
                    $threeSixty.nextFrame();
                });

                $('.prev').click(function () {
                    $threeSixty.prevFrame();
                });

                $threeSixty.on('down', function () {
                    $('.ui, h1, h2, .label, .examples').stop().animate({opacity: 1}, 300);
                });

                $threeSixty.on('up', function () {
                    $('.ui, h1, h2, .label, .examples').stop().animate({opacity: 1}, 500);
                });


            })();
        </script>
    </body>
</html>
